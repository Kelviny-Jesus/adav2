import{r as l,j as e,u as N}from"./index-4MufcReh.js";import{L as j}from"./components-ki2z-XRs.js";const v=({isOpen:d,onClose:h,email:u,onVerifySuccess:p})=>{const[c,x]=l.useState(["","","","","",""]),[o,n]=l.useState(null),[g,r]=l.useState(!1);if(!d)return null;const b=(a,s)=>{if(s&&!/^\d+$/.test(s))return;const t=[...c];if(s.length>1&&a===0&&s.length===6&&/^\d+$/.test(s)){const m=s.split("");x(m);const f=document.getElementById("code-input-5");f&&f.focus();return}if(t[a]=s,x(t),s&&a<5){const m=document.getElementById(`code-input-${a+1}`);m&&m.focus()}},i=(a,s)=>{if(s.key==="Backspace"&&!c[a]&&a>0){const t=document.getElementById(`code-input-${a-1}`);t&&t.focus()}},w=async()=>{const a=c.join("");if(a.length!==6){n("Please enter a 6-digit verification code");return}r(!0),n(null);try{const s=await fetch("https://n8n-blue.up.railway.app/webhook/ada/api/verify-reset-code",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:u,code:a})}),t=await s.json();if(!s.ok||!t.status){n(t.msg||"Invalid verification code. Please try again."),r(!1);return}p()}catch(s){n("An unexpected error occurred. Please try again."),console.error(s)}finally{r(!1)}};return e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-70 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-[#0d1117] rounded-lg p-8 w-full max-w-md relative border border-gray-800",children:[e.jsx("button",{onClick:h,className:"absolute top-4 right-4 text-gray-400 hover:text-white bg-transparent border-0 outline-none p-0",children:e.jsx("div",{className:"i-ph:x text-xl"})}),e.jsxs("div",{className:"text-center mb-8",children:[e.jsx("h2",{className:"text-2xl font-bold text-white mb-2",children:"Verify Code"}),e.jsxs("p",{className:"text-gray-300",children:["Enter the 6-digit code sent to ",u]})]}),o&&e.jsx("div",{className:"bg-red-500 text-white p-3 rounded-md mb-4",children:o}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-gray-200 block",children:"Verification Code"}),e.jsx("div",{className:"flex justify-between gap-2",children:c.map((a,s)=>e.jsx("input",{id:`code-input-${s}`,type:"text",maxLength:1,className:"w-full aspect-square text-center px-0 py-2 bg-[#0a0a0c] border border-gray-800 text-white text-xl font-bold focus:border-blue-500 focus:ring-blue-500 rounded-md",value:a,onChange:t=>b(s,t.target.value),onKeyDown:t=>i(s,t),autoFocus:s===0},s))})]}),e.jsx("button",{onClick:w,className:"w-full bg-[#1a2b4c] hover:bg-[#1f3461] text-white py-2 rounded-md",disabled:g,children:g?"Verifying...":"Verify Code"}),e.jsx("div",{className:"text-center mt-4",children:e.jsx("button",{onClick:h,className:"text-gray-400 hover:text-white bg-transparent border-0 outline-none p-0",children:"Cancel"})})]})]})})},P=({isOpen:d,onClose:h,email:u,onResetSuccess:p})=>{const[c,x]=l.useState(""),[o,n]=l.useState(""),[g,r]=l.useState(null),[b,i]=l.useState(!1);if(!d)return null;const w=s=>/^(?=.*[a-z])(?=.*[A-Z])(?=.*\d)(?=.*[@$!%*?&])[A-Za-z\d@$!%*?&]{8,}$/.test(s),a=async()=>{if(!c||!o){r("Both password fields are required");return}if(c!==o){r("Passwords do not match");return}if(!w(c)){r("Password must be at least 8 characters long and include 1 uppercase letter, 1 lowercase letter, 1 number, and 1 special character");return}i(!0),r(null);try{const s=await fetch("https://n8n-blue.up.railway.app/webhook/ada/api/reset/password",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:u,password:c})}),t=await s.json();if(!s.ok||!t.status){r(t.msg||"Failed to reset password. Please try again."),i(!1);return}p()}catch(s){r("An unexpected error occurred. Please try again."),console.error(s)}finally{i(!1)}};return e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-70 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-[#0d1117] rounded-lg p-8 w-full max-w-md relative border border-gray-800",children:[e.jsx("button",{onClick:h,className:"absolute top-4 right-4 text-gray-400 hover:text-white",children:e.jsx("div",{className:"i-ph:x text-xl"})}),e.jsxs("div",{className:"text-center mb-8",children:[e.jsx("h2",{className:"text-2xl font-bold text-white mb-2",children:"Reset Password"}),e.jsxs("p",{className:"text-gray-300",children:["Create a new password for ",u]})]}),g&&e.jsx("div",{className:"bg-red-500 text-white p-3 rounded-md mb-4",children:g}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{htmlFor:"password",className:"text-gray-200 block",children:"New Password"}),e.jsx("input",{id:"password",type:"password",className:"w-full px-3 py-2 bg-[#0a0a0c] border border-gray-800 text-white placeholder-gray-500 focus:border-blue-500 focus:ring-blue-500 rounded-md",value:c,onChange:s=>x(s.target.value),autoFocus:!0}),e.jsx("p",{className:"text-xs text-gray-400 mt-1",children:"Password must be at least 8 characters long and include 1 uppercase letter, 1 lowercase letter, 1 number, and 1 special character."})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{htmlFor:"confirmPassword",className:"text-gray-200 block",children:"Confirm New Password"}),e.jsx("input",{id:"confirmPassword",type:"password",className:"w-full px-3 py-2 bg-[#0a0a0c] border border-gray-800 text-white placeholder-gray-500 focus:border-blue-500 focus:ring-blue-500 rounded-md",value:o,onChange:s=>n(s.target.value)})]}),e.jsx("button",{onClick:a,className:"w-full bg-[#1a2b4c] hover:bg-[#1f3461] text-white py-2 rounded-md",disabled:b,children:b?"Resetting...":"Reset Password"}),e.jsx("div",{className:"text-center mt-4",children:e.jsx("button",{onClick:h,className:"text-gray-400 hover:text-white",children:"Cancel"})})]})]})})};function k(){const[d,h]=l.useState(""),[u,p]=l.useState(null),[c,x]=l.useState(null),[o,n]=l.useState(!1),[g,r]=l.useState(!1),[b,i]=l.useState(!1),w=N(),a=async m=>{m.preventDefault(),n(!0),p(null),x(null);try{const f=await fetch("https://n8n-blue.up.railway.app/webhook/ada/api/send-reset-code",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:d})}),y=await f.json();f.status===201&&y.status?(x("Reset code sent successfully. Please check your email."),r(!0)):p(y.msg)}catch(f){p("An unexpected error occurred. Please try again."),console.error(f)}finally{n(!1)}},s=()=>{r(!1),i(!0)},t=()=>{i(!1),x("Password reset successfully. You will be redirected to login."),setTimeout(()=>{w("/login")},3e3)};return e.jsxs("div",{className:"min-h-screen flex flex-col bg-[#0a0a0c] bg-gradient-to-br from-[#0a0a0c] via-[#0d1117] to-[#131c2e] relative",children:[e.jsx("div",{className:"absolute inset-0 bg-[url('data:image/svg+xml;base64PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI0MCIgaGVpZ2h0PSI0MCIgdmlld0JveD0iMCAwIDQwIDQwIj48ZyBmaWxsPSIjMDAwIiBmaWxsLW9wYWNpdHk9IjAuMDUiPjxwYXRoIGQ9Ik0yMCAyMGgyMHYyMEgyMHoiLz48cGF0aCBkPSJNMCAwaDIwdjIwSDB6Ii8+PC9nPjwvc3ZnPg==')] opacity-50"}),e.jsx("header",{className:"p-4 relative",children:e.jsx("div",{className:"container mx-auto",children:e.jsxs(j,{to:"/",className:"flex items-center gap-2",children:[e.jsxs("svg",{width:"32",height:"32",viewBox:"0 0 32 32",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[e.jsx("circle",{cx:"16",cy:"16",r:"12",stroke:"white",strokeWidth:"1.5"}),e.jsx("circle",{cx:"16",cy:"16",r:"3",fill:"white"}),e.jsx("circle",{cx:"16",cy:"9",r:"1.5",fill:"white"}),e.jsx("circle",{cx:"16",cy:"23",r:"1.5",fill:"white"}),e.jsx("circle",{cx:"9",cy:"16",r:"1.5",fill:"white"}),e.jsx("circle",{cx:"23",cy:"16",r:"1.5",fill:"white"})]}),e.jsx("span",{className:"text-white text-xl font-semibold",children:"Ada"})]})})}),e.jsx("main",{className:"flex-1 flex items-center justify-center p-6 relative",children:e.jsxs("div",{className:"w-full max-w-md space-y-8",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("h1",{className:"text-4xl font-bold text-white",children:"Reset Password"}),e.jsx("p",{className:"mt-2 text-gray-400",children:"Enter your email to receive a password reset code"})]}),e.jsxs("div",{className:"bg-[#0d1117] bg-opacity-50 backdrop-blur-sm rounded-lg p-8 shadow-2xl border border-gray-800",children:[u&&e.jsx("div",{className:"bg-red-500 text-white p-3 rounded-md mb-4",children:u}),c&&e.jsx("div",{className:"bg-green-500 text-white p-3 rounded-md mb-4",children:c}),e.jsxs("form",{onSubmit:a,className:"space-y-6",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{htmlFor:"email",className:"text-gray-200 block",children:"Email"}),e.jsx("input",{id:"email",name:"email",type:"email",autoComplete:"email",placeholder:"your@email.com",className:"w-full px-3 py-2 bg-[#0a0a0c] border border-gray-800 text-white placeholder-gray-500 focus:border-gray-700 focus:ring-gray-700 rounded-md",required:!0,value:d,onChange:m=>h(m.target.value)})]}),e.jsx("button",{type:"submit",className:"w-full bg-[#1a2b4c] hover:bg-[#1f3461] text-white py-2 rounded-md",disabled:o,children:o?"Sending...":"Send Reset Code"})]}),e.jsxs("div",{className:"mt-6 text-center",children:[e.jsxs("p",{className:"text-gray-400",children:["Remember your password?"," ",e.jsx(j,{to:"/login",className:"text-gray-200 hover:text-white",children:"Sign in"})]}),e.jsxs("p",{className:"mt-4 text-gray-400",children:["Already have a code?"," ",e.jsx("button",{onClick:()=>r(!0),className:"text-gray-200 hover:text-white bg-transparent border-none p-0 cursor-pointer",children:"Enter verification code"})]})]})]})]})}),e.jsx("footer",{className:"py-4 relative",children:e.jsxs("div",{className:"container mx-auto text-center text-gray-500 text-sm",children:["Â© ",new Date().getFullYear()," Ada. All rights reserved."]})}),e.jsx(v,{isOpen:g,onClose:()=>r(!1),email:d,onVerifySuccess:s}),e.jsx(P,{isOpen:b,onClose:()=>i(!1),email:d,onResetSuccess:t})]})}export{k as default};
