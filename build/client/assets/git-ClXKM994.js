import{a as pe,r as b,j as u}from"./index-4MufcReh.js";import{K as me,S as fe,M as n,O as ge,Q as he,R as $,U as ve,V as Se,W as A,X as F,Y as ye,Z as xe,_ as V,$ as we,a0 as be,a1 as Te,a2 as je,a3 as _e,a4 as Ie}from"./Header-XJOY0Kwv.js";import"./index-BoFGafk4.js";import"./index-DgoachrA.js";import"./profile-BYW5p1bK.js";import"./components-ki2z-XRs.js";var J="vercel.ai.error",Ee=Symbol.for(J),U,Oe=class q extends Error{constructor({name:t,message:r,cause:a}){super(r),this[U]=!0,this.name=t,this.cause=a}static isInstance(t){return q.hasMarker(t,J)}static hasMarker(t,r){const a=Symbol.for(r);return t!=null&&typeof t=="object"&&a in t&&typeof t[a]=="boolean"&&t[a]===!0}};U=Ee;var m=Oe;function z(e){return e==null?"unknown error":typeof e=="string"?e:e instanceof Error?e.message:JSON.stringify(e)}var B="AI_InvalidArgumentError",G=`vercel.ai.error.${B}`,Me=Symbol.for(G),H,Re=class extends m{constructor({message:e,cause:t,argument:r}){super({name:B,message:e,cause:t}),this[H]=!0,this.argument=r}static isInstance(e){return m.hasMarker(e,G)}};H=Me;var L="AI_JSONParseError",X=`vercel.ai.error.${L}`,Ae=Symbol.for(X),K,D=class extends m{constructor({text:e,cause:t}){super({name:L,message:`JSON parsing failed: Text: ${e}.
Error message: ${z(t)}`,cause:t}),this[K]=!0,this.text=e}static isInstance(e){return m.hasMarker(e,X)}};K=Ae;var Y="AI_TypeValidationError",Q=`vercel.ai.error.${Y}`,De=Symbol.for(Q),W,Pe=class T extends m{constructor({value:t,cause:r}){super({name:Y,message:`Type validation failed: Value: ${JSON.stringify(t)}.
Error message: ${z(r)}`,cause:r}),this[W]=!0,this.value=t}static isInstance(t){return m.hasMarker(t,Q)}static wrap({value:t,cause:r}){return T.isInstance(r)&&r.value===t?r:new T({value:t,cause:r})}};W=De;var P=Pe;function Ce(e){return new ReadableStream({async pull(t){try{const{value:r,done:a}=await e.next();a?t.close():t.enqueue(r)}catch(r){t.error(r)}},cancel(){}})}var f=({prefix:e,size:t=16,alphabet:r="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz",separator:a="-"}={})=>{const o=me(r,t);if(e==null)return o;if(r.includes(a))throw new Re({argument:"separator",message:`The separator "${a}" must not be part of the alphabet "${r}".`});return s=>`${e}${a}${o(s)}`},C=f(),j=Symbol.for("vercel.ai.validator");function ke(e){return{[j]:!0,validate:e}}function Ne(e){return typeof e=="object"&&e!==null&&j in e&&e[j]===!0&&"validate"in e}function $e(e){return Ne(e)?e:Fe(e)}function Fe(e){return ke(t=>{const r=e.safeParse(t);return r.success?{success:!0,value:r.data}:{success:!1,error:r.error}})}function Z({value:e,schema:t}){const r=$e(t);try{if(r.validate==null)return{success:!0,value:e};const a=r.validate(e);return a.success?a:{success:!1,error:P.wrap({value:e,cause:a.error})}}catch(a){return{success:!1,error:P.wrap({value:e,cause:a})}}}function Ve({text:e,schema:t}){try{const r=fe.parse(e);if(t==null)return{success:!0,value:r,rawValue:r};const a=Z({value:r,schema:t});return a.success?{...a,rawValue:r}:a}catch(r){return{success:!1,error:D.isInstance(r)?r:new D({text:e,cause:r})}}}var Je=Object.defineProperty,I=(e,t)=>{for(var r in t)Je(e,r,{get:t[r],enumerable:!0})};function ee(e,{contentType:t,dataStreamVersion:r}){const a=new Headers(e??{});return a.has("Content-Type")||a.set("Content-Type",t),a.set("X-Vercel-AI-Data-Stream",r),a}var te="AI_NoObjectGeneratedError",re=`vercel.ai.error.${te}`,Ue=Symbol.for(re),ae,k=class extends m{constructor({message:e="No object generated.",cause:t,text:r,response:a,usage:o}){super({name:te,message:e,cause:t}),this[ae]=!0,this.text=r,this.response=a,this.usage=o}static isInstance(e){return m.hasMarker(e,re)}};ae=Ue;var ne=n.union([n.string(),n.instanceof(Uint8Array),n.instanceof(ArrayBuffer),n.custom(e=>{var t,r;return(r=(t=globalThis.Buffer)==null?void 0:t.isBuffer(e))!=null?r:!1},{message:"Must be a Buffer"})]),_=n.lazy(()=>n.union([n.null(),n.string(),n.number(),n.boolean(),n.record(n.string(),_),n.array(_)])),l=n.record(n.string(),n.record(n.string(),_)),qe=n.array(n.union([n.object({type:n.literal("text"),text:n.string()}),n.object({type:n.literal("image"),data:n.string(),mimeType:n.string().optional()})])),oe=n.object({type:n.literal("text"),text:n.string(),providerOptions:l.optional(),experimental_providerMetadata:l.optional()}),ze=n.object({type:n.literal("image"),image:n.union([ne,n.instanceof(URL)]),mimeType:n.string().optional(),providerOptions:l.optional(),experimental_providerMetadata:l.optional()}),Be=n.object({type:n.literal("file"),data:n.union([ne,n.instanceof(URL)]),mimeType:n.string(),providerOptions:l.optional(),experimental_providerMetadata:l.optional()}),Ge=n.object({type:n.literal("reasoning"),text:n.string(),providerOptions:l.optional(),experimental_providerMetadata:l.optional()}),He=n.object({type:n.literal("redacted-reasoning"),data:n.string(),providerOptions:l.optional(),experimental_providerMetadata:l.optional()}),Le=n.object({type:n.literal("tool-call"),toolCallId:n.string(),toolName:n.string(),args:n.unknown(),providerOptions:l.optional(),experimental_providerMetadata:l.optional()}),Xe=n.object({type:n.literal("tool-result"),toolCallId:n.string(),toolName:n.string(),result:n.unknown(),content:qe.optional(),isError:n.boolean().optional(),providerOptions:l.optional(),experimental_providerMetadata:l.optional()}),Ke=n.object({role:n.literal("system"),content:n.string(),providerOptions:l.optional(),experimental_providerMetadata:l.optional()}),Ye=n.object({role:n.literal("user"),content:n.union([n.string(),n.array(n.union([oe,ze,Be]))]),providerOptions:l.optional(),experimental_providerMetadata:l.optional()}),Qe=n.object({role:n.literal("assistant"),content:n.union([n.string(),n.array(n.union([oe,Ge,He,Le]))]),providerOptions:l.optional(),experimental_providerMetadata:l.optional()}),We=n.object({role:n.literal("tool"),content:n.array(Xe),providerOptions:l.optional(),experimental_providerMetadata:l.optional()});n.union([Ke,Ye,Qe,We]);var Ze="JSON schema:",et="You MUST answer with a JSON object that matches the JSON schema above.",tt="You MUST answer with JSON.";function rt({prompt:e,schema:t,schemaPrefix:r=t!=null?Ze:void 0,schemaSuffix:a=t!=null?et:tt}){return[e!=null&&e.length>0?e:void 0,e!=null&&e.length>0?"":void 0,r,t!=null?JSON.stringify(t):void 0,a].filter(o=>o!=null).join(`
`)}f({prefix:"aiobj",size:24});f({prefix:"aiobj",size:24});f({prefix:"aitxt",size:24});f({prefix:"msg",size:24});var at={};I(at,{object:()=>ot,text:()=>nt});var nt=()=>({type:"text",responseFormat:()=>({type:"text"}),injectIntoSystemPrompt({system:e}){return e},parsePartial({text:e}){return{partial:e}},parseOutput({text:e}){return e}}),ot=({schema:e})=>{const t=ge(e);return{type:"object",responseFormat:({model:r})=>({type:"json",schema:r.supportsStructuredOutputs?t.jsonSchema:void 0}),injectIntoSystemPrompt({system:r,model:a}){return a.supportsStructuredOutputs?r:rt({prompt:r,schema:t.jsonSchema})},parsePartial({text:r}){const a=he(r);switch(a.state){case"failed-parse":case"undefined-input":return;case"repaired-parse":case"successful-parse":return{partial:a.value};default:{const o=a.state;throw new Error(`Unsupported parse state: ${o}`)}}},parseOutput({text:r},a){const o=Ve({text:r});if(!o.success)throw new k({message:"No object generated: could not parse the response.",cause:o.error,text:r,response:a.response,usage:a.usage});const s=Z({value:o.value,schema:t});if(!s.success)throw new k({message:"No object generated: response did not match schema.",cause:s.error,text:r,response:a.response,usage:a.usage});return s.value}}};function se(e,t){const r=e.getReader(),a=t.getReader();let o,s,d=!1,g=!1;async function v(i){try{o==null&&(o=r.read());const c=await o;o=void 0,c.done?i.close():i.enqueue(c.value)}catch(c){i.error(c)}}async function y(i){try{s==null&&(s=a.read());const c=await s;s=void 0,c.done?i.close():i.enqueue(c.value)}catch(c){i.error(c)}}return new ReadableStream({async pull(i){try{if(d){await y(i);return}if(g){await v(i);return}o==null&&(o=r.read()),s==null&&(s=a.read());const{result:c,reader:S}=await Promise.race([o.then(h=>({result:h,reader:r})),s.then(h=>({result:h,reader:a}))]);c.done||i.enqueue(c.value),S===r?(o=void 0,c.done&&(await y(i),d=!0)):(s=void 0,c.done&&(g=!0,await v(i)))}catch(c){i.error(c)}},cancel(){r.cancel(),a.cancel()}})}f({prefix:"aitxt",size:24});f({prefix:"msg",size:24});var st={};I(st,{mergeIntoDataStream:()=>ct,toDataStream:()=>it,toDataStreamResponse:()=>lt});function ie(e={}){const t=new TextEncoder;let r="";return new TransformStream({async start(){e.onStart&&await e.onStart()},async transform(a,o){o.enqueue(t.encode(a)),r+=a,e.onToken&&await e.onToken(a),e.onText&&typeof a=="string"&&await e.onText(a)},async flush(){e.onCompletion&&await e.onCompletion(r),e.onFinal&&await e.onFinal(r)}})}function E(e,t){return e.pipeThrough(new TransformStream({transform:async(r,a)=>{var o;if(typeof r=="string"){a.enqueue(r);return}if("event"in r){r.event==="on_chat_model_stream"&&N((o=r.data)==null?void 0:o.chunk,a);return}N(r,a)}})).pipeThrough(ie(t)).pipeThrough(new TextDecoderStream).pipeThrough(new TransformStream({transform:async(r,a)=>{a.enqueue($("text",r))}}))}function it(e,t){return E(e,t).pipeThrough(new TextEncoderStream)}function lt(e,t){var r;const a=E(e,t?.callbacks).pipeThrough(new TextEncoderStream),o=t?.data,s=t?.init,d=o?se(o.stream,a):a;return new Response(d,{status:(r=s?.status)!=null?r:200,statusText:s?.statusText,headers:ee(s?.headers,{contentType:"text/plain; charset=utf-8",dataStreamVersion:"v1"})})}function ct(e,t){t.dataStream.merge(E(e,t.callbacks))}function N(e,t){if(typeof e.content=="string")t.enqueue(e.content);else{const r=e.content;for(const a of r)a.type==="text"&&t.enqueue(a.text)}}var ut={};I(ut,{mergeIntoDataStream:()=>mt,toDataStream:()=>dt,toDataStreamResponse:()=>pt});function O(e,t){const r=ft();return Ce(e[Symbol.asyncIterator]()).pipeThrough(new TransformStream({async transform(a,o){o.enqueue(r(a.delta))}})).pipeThrough(ie(t)).pipeThrough(new TextDecoderStream).pipeThrough(new TransformStream({transform:async(a,o)=>{o.enqueue($("text",a))}}))}function dt(e,t){return O(e,t).pipeThrough(new TextEncoderStream)}function pt(e,t={}){var r;const{init:a,data:o,callbacks:s}=t,d=O(e,s).pipeThrough(new TextEncoderStream),g=o?se(o.stream,d):d;return new Response(g,{status:(r=a?.status)!=null?r:200,statusText:a?.statusText,headers:ee(a?.headers,{contentType:"text/plain; charset=utf-8",dataStreamVersion:"v1"})})}function mt(e,t){t.dataStream.merge(O(e,t.callbacks))}function ft(){let e=!0;return t=>(e&&(t=t.trimStart(),t&&(e=!1)),t)}const gt=["node_modules/**",".git/**",".github/**",".vscode/**","**/*.jpg","**/*.jpeg","**/*.png","dist/**","build/**",".next/**","coverage/**",".cache/**",".vscode/**",".idea/**","**/*.log","**/.DS_Store","**/npm-debug.log*","**/yarn-debug.log*","**/yarn-error.log*","**/*lock.json","**/*lock.yaml"];function ht(){const[e]=pe(),{ready:t,importChat:r}=ve(),{ready:a,gitClone:o}=Se(),[s,d]=b.useState(!1),[g,v]=b.useState(!0),y=async i=>{if(!(!a&&!t)&&i){const c=we().add(gt);try{const{workdir:S,data:h}=await o(i);if(r){const le=Object.keys(h).filter(p=>!c.ignores(p)),ce=new TextDecoder("utf-8"),M=le.map(p=>{const{data:w,encoding:de}=h[p];return{path:p,content:de==="utf8"?w:w instanceof Uint8Array?ce.decode(w):""}}).filter(p=>p.content),ue=await be(M),R=Te(ue),x=[{role:"assistant",content:`Cloning the repo ${i} into ${S}
<boltArtifact id="imported-files" title="Git Cloned Files"  type="bundled">
${M.map(p=>`<boltAction type="file" filePath="${p.path}">
${je(p.content)}
</boltAction>`).join(`
`)}
</boltArtifact>`,id:C(),createdAt:new Date}];R&&(x.push({role:"user",id:C(),content:"Setup the codebase and Start the application"}),x.push(R)),await r(`Git Project:${i.split("/").slice(-1)[0]}`,x,{gitUrl:i})}}catch(S){console.error("Error during import:",S),A.error("Failed to import repository"),v(!1),window.location.href="/";return}}};return b.useEffect(()=>{if(!t||!a||s)return;const i=e.get("url");if(!i){window.location.href="/";return}y(i).catch(c=>{console.error("Error importing repo:",c),A.error("Failed to import repository"),v(!1),window.location.href="/"}),d(!0)},[e,t,a,s]),u.jsx(F,{fallback:u.jsx(V,{}),children:()=>u.jsxs(u.Fragment,{children:[u.jsx(ye,{}),g&&u.jsx(xe,{message:"Please wait while we clone the repository..."})]})})}const jt=()=>[{title:"Ada"},{name:"description",content:"Talk with Ada, an AI assistant from StackBlitz"}];function _t(){return u.jsxs("div",{className:"flex flex-col h-full w-full bg-bolt-elements-background-depth-1",children:[u.jsx(_e,{}),u.jsx(Ie,{}),u.jsx(F,{fallback:u.jsx(V,{}),children:()=>u.jsx(ht,{})})]})}export{_t as default,jt as meta};
