import{r as c,u as k,b as D,j as e}from"./index-5yin8JJm.js";import{L as v}from"./components-Bwa7pH9e.js";async function M(r){const d=r.get("email"),o=r.get("password"),p=r.get("confirmPassword");if(!d||!o||!p)return{error:"Email and passwords are required"};if(o!==p)return{error:"Passwords do not match"};if(!/^(?=.*[a-z])(?=.*[A-Z])(?=.*\d)(?=.*[@$!%*?&])[A-Za-z\d@$!%*?&]{8,}$/.test(o))return{error:"Password must be at least 8 characters long and include 1 uppercase letter, 1 lowercase letter, 1 number, and 1 special character"};try{const u=await(await fetch("https://n8n-blue.up.railway.app/webhook/ada/api/reset/password",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:d,password:o})})).json();return u.status?{success:!0,message:"Password reset successfully"}:{error:u.msg}}catch(w){return console.error("Error resetting password:",w),{error:"Failed to reset password. Please try again."}}}function R(){const[r,d]=c.useState(["","","","","",""]),[o,p]=c.useState(""),[g,w]=c.useState(""),[u,l]=c.useState(null),[h,f]=c.useState(null),[y,m]=c.useState(!1),[x,N]=c.useState(""),P=k(),b=D();c.useEffect(()=>{const s=new URLSearchParams(b.search).get("email");s&&N(s)},[b]);const I=(t,s)=>{if(s&&!/^\d+$/.test(s))return;const a=[...r];if(s.length>1&&t===0&&s.length===6&&/^\d+$/.test(s)){const i=s.split("");d(i);const n=document.getElementById("code-input-5");n&&n.focus();return}if(a[t]=s,d(a),s&&t<5){const i=document.getElementById(`code-input-${t+1}`);i&&i.focus()}},C=(t,s)=>{if(s.key==="Backspace"&&!r[t]&&t>0){const a=document.getElementById(`code-input-${t-1}`);a&&a.focus()}},S=async t=>{t.preventDefault(),m(!0),l(null),f(null);const s=r.join("");if(s.length!==6){l("Please enter a 6-digit verification code"),m(!1);return}if(o!==g){l("Passwords do not match"),m(!1);return}try{const a=await fetch("https://n8n-blue.up.railway.app/webhook/ada/api/verify-reset-code",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:x,code:s})}),i=await a.json();if(!a.ok||!i.status){l(i.msg||"Invalid verification code. Please try again."),m(!1);return}const n=new FormData;n.append("email",x),n.append("password",o),n.append("confirmPassword",g);const j=await M(n);j.success?(f("Password reset successfully. You will be redirected to login."),setTimeout(()=>{P("/login")},3e3)):l(j.error||"Failed to reset password. Please try again.")}catch(a){l("An unexpected error occurred. Please try again."),console.error(a)}finally{m(!1)}};return e.jsxs("div",{className:"min-h-screen flex flex-col bg-[#0a0a0c] bg-gradient-to-br from-[#0a0a0c] via-[#0d1117] to-[#131c2e] relative",children:[e.jsx("div",{className:"absolute inset-0 bg-[url('data:image/svg+xml;base64PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI0MCIgaGVpZ2h0PSI0MCIgdmlld0JveD0iMCAwIDQwIDQwIj48ZyBmaWxsPSIjMDAwIiBmaWxsLW9wYWNpdHk9IjAuMDUiPjxwYXRoIGQ9Ik0yMCAyMGgyMHYyMEgyMHoiLz48cGF0aCBkPSJNMCAwaDIwdjIwSDB6Ii8+PC9nPjwvc3ZnPg==')] opacity-50"}),e.jsx("header",{className:"p-4 relative",children:e.jsx("div",{className:"container mx-auto",children:e.jsxs(v,{to:"/",className:"flex items-center gap-2",children:[e.jsxs("svg",{width:"32",height:"32",viewBox:"0 0 32 32",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[e.jsx("circle",{cx:"16",cy:"16",r:"12",stroke:"white",strokeWidth:"1.5"}),e.jsx("circle",{cx:"16",cy:"16",r:"3",fill:"white"}),e.jsx("circle",{cx:"16",cy:"9",r:"1.5",fill:"white"}),e.jsx("circle",{cx:"16",cy:"23",r:"1.5",fill:"white"}),e.jsx("circle",{cx:"9",cy:"16",r:"1.5",fill:"white"}),e.jsx("circle",{cx:"23",cy:"16",r:"1.5",fill:"white"})]}),e.jsx("span",{className:"text-white text-xl font-semibold",children:"Ada"})]})})}),e.jsx("main",{className:"flex-1 flex items-center justify-center p-6 relative",children:e.jsxs("div",{className:"w-full max-w-md space-y-8",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("h1",{className:"text-4xl font-bold text-white",children:"Verify Code"}),e.jsx("p",{className:"mt-2 text-gray-400",children:"Enter the 6-digit code sent to your email"})]}),e.jsxs("div",{className:"bg-[#0d1117] bg-opacity-50 backdrop-blur-sm rounded-lg p-8 shadow-2xl border border-gray-800",children:[u&&e.jsx("div",{className:"bg-red-500 text-white p-3 rounded-md mb-4",children:u}),h&&e.jsx("div",{className:"bg-green-500 text-white p-3 rounded-md mb-4",children:h}),e.jsxs("form",{onSubmit:S,className:"space-y-6",children:[e.jsx("input",{type:"hidden",name:"email",value:x}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-gray-200 block",children:"Verification Code"}),e.jsx("div",{className:"flex justify-between gap-2",children:r.map((t,s)=>e.jsx("input",{id:`code-input-${s}`,type:"text",maxLength:1,className:"w-full aspect-square text-center px-0 py-2 bg-[#0a0a0c] border border-gray-800 text-white text-xl font-bold focus:border-blue-500 focus:ring-blue-500 rounded-md",value:t,onChange:a=>I(s,a.target.value),onKeyDown:a=>C(s,a),autoFocus:s===0},s))})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{htmlFor:"password",className:"text-gray-200 block",children:"New Password"}),e.jsx("input",{id:"password",name:"password",type:"password",className:"w-full px-3 py-2 bg-[#0a0a0c] border border-gray-800 text-white placeholder-gray-500 focus:border-gray-700 focus:ring-gray-700 rounded-md",required:!0,value:o,onChange:t=>p(t.target.value)})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{htmlFor:"confirmPassword",className:"text-gray-200 block",children:"Confirm New Password"}),e.jsx("input",{id:"confirmPassword",name:"confirmPassword",type:"password",className:"w-full px-3 py-2 bg-[#0a0a0c] border border-gray-800 text-white placeholder-gray-500 focus:border-gray-700 focus:ring-gray-700 rounded-md",required:!0,value:g,onChange:t=>w(t.target.value)})]}),e.jsx("button",{type:"submit",className:"w-full bg-[#1a2b4c] hover:bg-[#1f3461] text-white py-2 rounded-md",disabled:y,children:y?"Resetting...":"Reset Password"})]}),e.jsx("div",{className:"mt-6 text-center",children:e.jsxs("p",{className:"text-gray-400",children:["Didn't receive a code?"," ",e.jsx(v,{to:"/forgot-password",className:"text-gray-200 hover:text-white",children:"Request again"})]})})]})]})}),e.jsx("footer",{className:"py-4 relative",children:e.jsxs("div",{className:"container mx-auto text-center text-gray-500 text-sm",children:["Â© ",new Date().getFullYear()," Ada. All rights reserved."]})})]})}export{R as default};
